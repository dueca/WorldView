# -*-cmake-*-
# ============================================================================
#       item            : CMake configuration DUECA module
#       made by         : Ren√© van Paassen
#       date            : 180326
#       copyright       : (c) 2021 TUDelft-AE-C&S
# ============================================================================

include(DuecaAddDCO)
include(DuecaAddModule)
include(FindPkgConfig)

# all local sources, replace by set(SOURCES ...) to be selective
file(GLOB SOURCES "*.cxx" "*.hxx")
# set(SOURCES ...)

# DCO communication objects used by this module, generated from the
# comm-objects.lst file
# this sets the DCO_INCLUDE_DIRS variable in this scope, which lists
# all folders with generated and original DCO source files
# this sets the DCO_DEPENDS variable in this scope, which lists
# the dependencies on dco's in comm-objects folders for this module
dueca_add_dco()

# detect any needed libraries here with CMake's mechanisms, such as
# find_package, pkg_check_modules, or low-level find_path/find_library
#find_package(OGRE )

pkg_check_modules(OGRE OGRE-Overlay OGRE-Bites)
if (NOT OGRE_FOUND)
  # Bites is from Ogre 1.12, 1.9 (Fedora) does not have this
  pkg_check_modules(OGRE OGRE-Overlay)
endif()


find_package(X11)
find_package(OpenGL COMPONENTS GLX)
pkg_check_modules(TINYXML REQUIRED tinyxml)

# if you need specific define's for the compilation, give them here
set(CUSTOM_OPTIONS )

# add current module as target, optionally add required dueca components
dueca_add_module(
  SOURCES ${SOURCES} ${CMAKE_CURRENT_BINARY_DIR}/comm-objects.h

  # specify include directories, add for used libraries as needed
  INCLUDEDIRS ${DCO_INCLUDE_DIRS}
  ${OGRE_INCLUDE_DIRS}

  # optionally add more DUECA components (e.g., a graphics toolkit?)
  DUECA_COMPONENTS

  # if you directly use code from other modules here, specify these
  # in the form of project/module. Code generation order will be correct,
  # and the source location of these modules is added to the include path
  USEMODULES
  WorldView/WorldView

  # optionally specify libraries used for this module
  LIBRARIES
  ${OGRE_LIBRARIES} ${OGRE_Overlay_LIBRARIES} ${TINYXML_LIBRARIES}

  # give compiler options
  COMPILEOPTIONS ${CUSTOM_OPTIONS}
  )

# specify dependency on comm-objects
if(DCO_DEPENDS)
  add_dependencies(${CURRENT_MODULE} ${DCO_DEPENDS})
endif()
